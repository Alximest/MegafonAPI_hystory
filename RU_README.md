README
Описание проекта
Данный проект реализует скрипт для обработки данных о звонках и отправки их в телеграм-чат от API_MEGAFON. Скрипт собирает данные о внешних и внутренних звонках, сохраняет информацию в базу данных SQLite и отправляет уведомления в телеграм-чат.

Как запустить проект
Установите необходимые зависимости, указанные в файле requirements.txt, выполнив следующую команду:

pip install -r requirements.txt
Создайте файл .env в корневой директории проекта и укажите в нем значения следующих переменных окружения:

API*TOKEN=<ваш_API*токен*бота>
YOUR_CHAT_ID=<ID*вашего*телеграм*чата>

Запустите файл main.py, чтобы запустить скрипт обработки данных:

python main.py

Как работает проект

1. Скрипт обработки данных (script.py)
   Скрипт script.py предоставляет классы и функции для обработки данных о звонках.

Класс CallDataProcessor
CallDataProcessor отвечает за взаимодействие с базой данных SQLite, обработку данных и отправку POST-запросов на указанный сайт.
В конструкторе класса необходимо передать путь к файлу базы данных SQLite, где будут храниться номера клиентов.
Метод create_table создает таблицу clients в базе данных, если её еще нет.
Метод insert_client добавляет новый номер клиента в базу данных. Если номер уже существует, он игнорируется.
Метод process_json_file обрабатывает данные из внешнего JSON-файла и добавляет новые номера клиентов в базу данных.
Класс Message_Json_Ex
Message_Json_Ex отвечает за получение данных о внешних звонках.
Метод get_history отправляет запрос на внешний API и получает данные о звонках за текущую неделю. Затем данные сохраняются в JSON-файл.
Класс Message_Json_In
Message_Json_In отвечает за получение данных о внутренних звонках.
Метод get_history отправляет запрос на внутренний API и получает данные о звонках за текущую неделю. Затем данные сохраняются в JSON-файл.
Классы Call_Info_Ex и Call_Info_In
Call_Info_Ex и Call_Info_In отвечают за обработку данных о внешних и внутренних звонках соответственно.
Метод check_and_send_message проверяет новые данные о звонках и отправляет уведомление в телеграм-чат о новых звонках.
Метод create_message форматирует данные о звонке в удобочитаемое сообщение для отправки в телеграм-чат. 2. Отправка уведомлений в телеграм-чат
Для отправки уведомлений в телеграм-чат используется библиотека aiogram, которая предоставляет удобный интерфейс для работы с API Telegram Bot.
В файле bot.py определена функция send_data_to_chat, которая отправляет текстовое сообщение или аудиофайл с данными о звонках в телеграм-чат.
Как настроить отправку данных в телеграм-чат
Для отправки данных в телеграм-чат необходимо создать своего бота в Telegram и получить API токен. Затем укажите этот токен в файле .env, в переменной API_TOKEN.

Также укажите ID вашего телеграм-чата в переменной YOUR_CHAT_ID.

Примечание
Прежде чем запустить скрипт, убедитесь, что у вас есть доступ к API_MEGAFON

Автор
Alximest
